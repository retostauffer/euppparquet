{% extends "layout.html" %}
{% load i18n %}
{% load static %}

{% block css %}
<style>
div.home-icon {
    text-align: center !important;
}
div.home-icon img {
    width: 40%;
    min-width: 100px;
    padding-bottom: 3em;
}
</style>
{% endblock %}

{% block js %}
<script src="{% static "node_modules/datatables.net/js/jquery.dataTables.min.js" %}"></script>
<script>
$(document).ready(function() {
    $.ajax({
        url: "/api/test",
        data: {"csrfmiddlewaretoken": "{{ csrf_token }}", "orient": "records"},
        success: function(data) {
            if (data.warning) {
                alert(data.warning);
            } else {
                $("#grid").DataTable({
                    data: data.data,
                    columns: [
                        {
                            data: "_path",
                            render: function(val, type, full, meta) {
                                return "<a href='" + data.DATA_BASE_URL + "/" + val + "'>" +
                                    val.split("/").reverse()[0] + "</a>";
                            }
                        },
                        {data: "param"},
                        {data: "year",    className: "text-center" },
                        {data: "month",   className: "text-center" },
                        {data: "day",     className: "text-center" },
                        {data: "time",    className: "text-center" },
                        {data: "_offset", className: "text-right"  },
                        {data: "_length", className: "text-right"  },
                    ],

                });
            }
        }
    });
});
</script>
{% endblock %}

{% block content %}

<h1>EUPP Parquet API</h1>

{{ settings.DATA_BASE_URL }}

<table id="grid">
    <thead>
        <tr>
            <th>Grib file path</th>
            <th>Param</th>
            <th>Year</th>
            <th>Month</th>
            <th>Day</th>
            <th>Time</th>
            <th>Offset</th>
            <th>Length</th>
        </tr>
    </thead>
</table>

{% endblock %}





